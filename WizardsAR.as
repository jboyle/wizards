package {		import com.wizards.ARGameController;	import com.wizards.WizardsG;		import flash.events.Event;	import flash.events.MouseEvent;	import flash.net.URLLoader;	import flash.net.URLRequest;	import flash.utils.getTimer;		import org.papervision3d.lights.PointLight3D;	import org.papervision3d.materials.WireframeMaterial;	import org.papervision3d.materials.shadematerials.FlatShadeMaterial;	import org.papervision3d.materials.utils.MaterialsList;	import org.papervision3d.objects.primitives.Cube;	import org.papervision3d.objects.primitives.Plane;		//[SWF(width=640, height=480, backgroundColor=0x808080, frameRate=30)]	[SWF(width=800, height=600, backgroundColor=0xffffff, frameRate=60)]		public class WizardsAR extends PV3DARApp {				private var _plane:Plane;		private var _cube:Cube;		//private var _simpleGame:MovieClip;				private var _oldDetectedNum:int;				private var _arGameController:ARGameController;				private var _spellDataLoader:URLLoader;		private var _spellData:XML;				public function WizardsAR() {			// Initalize application with the path of camera calibration file and patter definition file.			// カメラ補正ファイルとパターン定義ファイルのファイル名を渡して初期化。			addEventListener(Event.INIT, _onInit);			//init('Data/camera_para.dat', 'Data/flarlogo.pat');	// 50%						// multi marker detection			var codeList:Array = new Array("data/marker_casting_16_50.pat", "data/marker_iceelement_16_50.pat", "data/marker_fireelement_16_50.pat");			//var codeList:Array = new Array("Data/marker1_32_50.pat", "Data/marker2_32_50.pat", "Data/marker3_32_50.pat");			//var codeList:Array = new Array("Data/marker3_16_50.pat");			initM('data/camera_para.dat', codeList);		}		private function _onInit(e:Event):void {			mirror = !mirror;						/*stage.addEventListener(MouseEvent.CLICK, _onClick);			addEventListener(Event.ENTER_FRAME, _onEnterFrame);*/						_spellDataLoader = new URLLoader();			_spellDataLoader.addEventListener(Event.COMPLETE, onSpellLoadComplete);						_spellDataLoader.load(new URLRequest("data/spell_data.xml"));		}				public function onSpellLoadComplete(ev:Event){			_spellData = new XML(_spellDataLoader.data);			WizardsG.SPELLS = _spellData.spells;			WizardsG.SYNTAX = _spellData.syntax;			WizardsG.TIMING = _spellData.timing;						_arGameController = new ARGameController();			_base.alpha = .25;			addChildAt(_arGameController,0);						_base.mouseEnabled = false;			//stage.addEventListener(MouseEvent.CLICK, _onClick);			addEventListener(Event.ENTER_FRAME, _onEnterFrame);		}				private function _onClick(e:MouseEvent):void {			//mirror = !mirror;					}				private function _onEnterFrame(e:Event = null):void		{						var t:uint = getTimer();			WizardsG.TIME_DIFF = (t-WizardsG.TIME)/1000;			WizardsG.TIME = t;						//trace("detectedNum: "+detectedNum+", oldDetectedNum: "+_oldDetectedNum);			/*trace(_detectedMarkers.length);			for(var i in _detectedMarkers){				trace(_detectedMarkers[i].codeId);			}*/			/*// protected var _resultMat:FLARTransMatResult = new FLARTransMatResult();						_arGameController.moveActivePhrase(_resultMat.intersectionX, _resultMat.intersectionY, _resultMat.rotationZDegree);			*/			_arGameController.updatePhrases(_detectedMarkers, _detectedNumFinal.length);			_arGameController.update();		}			}}